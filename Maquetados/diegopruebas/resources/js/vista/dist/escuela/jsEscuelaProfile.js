var escuelaProfile=function(){var c=$("#tab1"),n=$("#tab3"),e=$("#conModal"),t={},i=function(r){grupoService.list({idEscuela:t.idEscuela},function(e){var a=[];$("#gpo_count").html(e.length);for(var n=0;n<e.length;n++){var o=e[n],i=dateConverter.format.longStringToDate(o.gpoFechaCreacion);a.push({events:[{type:"click",action:"redirect('/grupo/profile/"+o.idGrupo+"')"}],cols:[{type:"card-table-image",src:o.gpoLogo,default:appDefaults.defaults.logoGrupo},{type:"card-table-content",label:"",value:o.gpoNombre.toUpperCase()},{type:"card-table-content",label:"Lugar de Reunion",value:o.gpoLugarReunion},{type:"card-table-content",label:"Fecha de Creacion",value:i}]})}var t=strings.random(8);components.render(c,components.cardTable.code(a,t)),components.cardTable.event(a,t),r()})};return{init:function(){t.idEscuela=parseInt($("#info_escuela_idEscuela").val()),t.nombre=$("#info_escuela_nombre").val(),t.idIglesia=parseInt($("#info_escuela_idIglesia").val()),i(function(){adminLeaders.listLeaders(2,n)})},remove:function(){confirmMessage({title:"Eliminar",content:"¿Seguro que desea eliminar esta escuela sabática?"},function(){escuelaService.remove({idEscuela:t.idEscuela},function(e){redirect("/iglesia/profile")})})},update:function(){var a=$("#escNombre").val(),e=$("#escLugarReunion").val(),n=$("#escFechaCreacion").val().split(" "),o="";o=validate.incomplete([n[1]])?dateConverter.format.datePickerToString($("#escFechaCreacion").val()):n[0];var i={idEscuela:t.idEscuela,iglesia:{idIglesia:t.idIglesia},escNombre:a,escLugarReunion:e,escFechaCreacion:dateConverter.format.datePickerToString(o),escFechaRegistro:new Date($("#info_escuela_escFechaRegistro").val()),escEstado:"1"};escuelaService.update(i,function(e){t.nombre=a,$("#tit_escuela").empty().append(a+'<i class="mdi-navigation-more-vert right"></i>'),$("#e_fec").empty().append("Fecha de Creación : "+o),$("#e_reu").empty().append("Lugar de Reunión : "+o),$("#escFechaCreacion").val(o)})},addGrupo:function(){var e=$("#n_gpoNombre").val(),a=$("#n_gpoFechaCreacion").val(),n=$("#n_gpoLugarReunion").val();if(validate.incomplete([e,a,n])){var o={escuela:{idEscuela:t.idEscuela},gpoNombre:e,gpoFechaCreacion:dateConverter.format.dateSlach(a),gpoLugarReunion:n};grupoService.add(o,function(e){i(function(){})})}else infoMessage({title:message.incomplete.title,content:message.incomplete.content})},addLeader:function(){var e=$("#persona").val(),a=$("#rolS").val();adminLeaders.addLeader(e,a,function(e){adminLeaders.listLeaders(2,n)})},regGrupo:function(){components.render(e,'<div class="modal-content"><h4>Registro de Grupo Pequeño</h4><div class="row"><div class="col l6 m12 s12 input-field"><input type="text" id="n_gpoNombre" name="n_gpoNombre" value=""/><label for="n_gpoNombre">Nombre del Grupo Pequeño</label></div><div class="col l6 m12 s12 input-field"><input type="text" id="n_gpoFechaCreacion" name="n_gpoFechaCreacion" value=""class="datepicker"/><label for="n_gpoFechaCreacion">Fecha de Creacion</label></div><div class="col l12 m12 s12 input-field"><input type="text" id="n_gpoLugarReunion" name="n_gpoLugarReunion" value=""/><label for="n_gpoLugarReunion">Lugar de Reunión</label></div></div></div>'),$("#saveModal").empty().append("Registrar"),$("#saveModal").attr("onclick","escuelaProfile.addGrupo()"),$(".datepicker").pickadate()},regLeader:function(){components.render(e,components.modalSetRol.code("persona-enabled","test",[{id:13,nombre:"Lider de Escuela Sabática"},{id:10,nombre:"MIPES de Escuela Sabática"}])),select2.init(),$("#saveModal").empty().append("Asignar"),$("#saveModal").attr("onclick","escuelaProfile.addLeader()")}}}();