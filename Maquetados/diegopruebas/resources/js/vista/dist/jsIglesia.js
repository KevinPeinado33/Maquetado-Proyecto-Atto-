var iglesiaAct,list_body=$("#list_body"),iService=new iglesiaService,idDistrito=$("#crm_idDistrito").val();function listIglesia(i){for(var e="",t=0;t<i.length;t++){var a=i[t],l=getLetter(a.iglNombre),s=new Date(a.iglFechaCreacion),o=s.getFullYear(),d=1+s.getMonth(),c=s.getDate();e+="<tr>",e+='<td style="width:38px;"><button class="btn-floating waves-effect waves-light '+getColor()+'">'+l+"</button></td>",e+='<td class="condensed"><h6><strong>'+a.iglNombre.toUpperCase()+"</strong></h6></td>",e+='<td class="tR"><small>Registrado el</small> '+c+"/"+d+"/"+o+"</td>",e+='<td class="tR">'+a.iglDireccion+"</td>",e+='<td style="float:right">',e+='<a class="grey-text tR" onclick="updateIglesia('+a.idIglesia+')"><i class="mdi-editor-mode-edit actCRUD"></i></a>',e+='<a class="grey-text tR" onclick="deleteIglesia('+a.idIglesia+')"><i class="mdi-action-delete actCRUD"></i></a>',e+='<a class="grey-text tR"><i class="mdi-social-group actCRUD"></i></a>',e+='<a class="grey-text tS"><i class="mdi-action-info-outline actCRUD"></i></a>',e+='<a class="grey-text dropdown-button tS" data-activates="dropdown'+t+'"><i class="mdi-navigation-more-vert actCRUD"></i></a>',e+='<ul id="dropdown'+t+'" class="dropdown-content">',e+='<li><a onclick="updateIglesia('+a.idIglesia+')" class="-text">Editar</a></li>',e+='<li><a onclick="deleteIglesia('+a.idIglesia+')" class="-text">Eliminar</a></li>',e+="</ul>",e+="</td>",e+="</tr>"}$(list_body).empty(),$(list_body).append(e),$(".dropdown-button").dropdown()}function updateIglesia(i){var e={idIglesia:i};iService.getIglesia(e,function(i){var e=createModal("update",(iglesiaAct=i).iglNombre,i.iglDireccion,"active");$(".modal-content").empty(),$(".modal-content").append(e),$("#modal1").openModal()})}function deleteIglesia(e){confirmMessage({title:"Eliminar Iglesia",content:"¿Seguro que desea eliminar este iglesia?"},function(){var i={idIglesia:e};iService.deleteIglesia(i,reload)})}function save(){var i,e=$("#nigl").val(),t=$("#lgreu").val(),a=$("#tipModal").val();""!==e&&""!==t?("create"===a&&(i={iglNombre:e,iglDireccion:t,distrito:{idDistrito:idDistrito}},iService.addIglesia(i,reload)),"update"===a&&(i={iglNombre:e,iglDireccion:t,idIglesia:iglesiaAct.idIglesia,iglEstado:iglesiaAct.iglEstado,iglUsuAdd:iglesiaAct.iglUsuAdd,iglFechaCreacion:iglesiaAct.iglFechaCreacion,iglFechaAdd:iglesiaAct.iglFechaAdd,distrito:{idDistrito:iglesiaAct.distrito.idDistrito}},iService.updateIglesia(i,reload))):alert("Campos Incompletos...")}function reload(i){0!==i&&iService.listIglesia({idDistrito:idDistrito},listIglesia)}function createModal(i,e,t,a){var l="";return l+='<h5 class="thin">Iglesia</h5>',l+='<div class="row">',l+='<form class="col s12">',l+='<div class="row">',l+='<div class="input-field col s12 l6 m6">',l+='<i class="mdi-social-group prefix"></i>',l+='<input id="nigl" type="text" class="validate" value="'+e+'">',l+='<label for="nigl" class="'+a+'">Nombre</label>',l+="</div>",l+='<div class="input-field col s12 l6 m6">',l+='<i class="mdi-action-home prefix"></i>',l+='<input id="lgreu" type="text" class="validate" value="'+t+'">',l+='<label for="lgreu" class="'+a+'">Dirección</label>',l+="</div>",l+="</div>",l+='<input type="hidden" value='+i+' id="tipModal">',l+="</form>",l+="</div>"}function createIglesia(){var i=createModal("create","","","");$(".modal-content").empty(),$(".modal-content").append(i),$("#modal1").openModal()}$(document).ready(function(){$(".titleTab").empty(),$(".titleTab").append("Listado de iglesias que pertencen al distrito misionero <strong>"+$("#crm_disNombre").val().toUpperCase()+"</strong>");var i={idDistrito:idDistrito};iService.listIglesia(i,listIglesia)});