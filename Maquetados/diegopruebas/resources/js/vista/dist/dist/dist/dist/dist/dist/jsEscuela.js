var escuelaAct,list_body=$("#list_body"),eService=new escuelaService,idIglesia=$("#crm_idIglesia").val();function listEscuela(e){for(var a="",t=0;t<e.length;t++){var l=e[t],s=getLetter(l.escNombre),c=new Date(l.escFechaCreacion),i=c.getFullYear(),d=1+c.getMonth(),o=c.getDate();a+="<tr>",a+='<td style="width:38px;"><button class="btn-floating waves-effect waves-light '+getColor()+'">'+s+"</button></td>",a+='<td class="condensed"><h6><strong>'+l.escNombre.toUpperCase()+"</strong></h6></td>",a+='<td class="tR"><small>Registrado el</small> '+o+"/"+d+"/"+i+"</td>",a+='<td class="tR">'+l.escLugarReunion+"</td>",a+='<td style="float:right">',a+='<a class="grey-text tR" onclick="updateEscuela('+l.idEscuela+')"><i class="mdi-editor-mode-edit actCRUD"></i></a>',a+='<a class="grey-text tR" onclick="deleteEscuela('+l.idEscuela+')"><i class="mdi-action-delete actCRUD"></i></a>',a+='<a class="grey-text tR"><i class="mdi-social-group actCRUD"></i></a>',a+='<a class="grey-text tS"><i class="mdi-action-info-outline actCRUD"></i></a>',a+='<a class="grey-text dropdown-button tS" data-activates="dropdown'+t+'"><i class="mdi-navigation-more-vert actCRUD"></i></a>',a+='<ul id="dropdown'+t+'" class="dropdown-content">',a+='<li><a onclick="updateEscuela('+l.idEscuela+')" class="-text">Editar</a></li>',a+='<li><a onclick="deleteEscuela('+l.idEscuela+')" class="-text">Eliminar</a></li>',a+='<li><a href="#!" class="-text">Miembros</a></li>',a+="</ul>",a+="</td>",a+="</tr>"}$(list_body).empty(),$(list_body).append(a),$(".dropdown-button").dropdown()}function updateEscuela(e){var a={idEscuela:e};eService.getEscuela(a,function(e){var a=createModal("update",(escuelaAct=e).escNombre,e.escLugarReunion,"active");$(".modal-content").empty(),$(".modal-content").append(a),$("#modal1").openModal()})}function deleteEscuela(a){confirmMessage({title:"Eliminar Escuela Sabática",content:"¿Seguro que desea eliminar este escuela?"},function(){var e={idEscuela:a};eService.deleteEscuela(e,reload)})}function save(){var e,a=$("#nesc").val(),t=$("#lgreu").val(),l=$("#tipModal").val();""!==a&&""!==t?("create"===l&&(e={escNombre:a,escLugarReunion:t,iglesia:{idIglesia:idIglesia}},eService.addEscuela(e,reload)),"update"===l&&(e={escNombre:a,escLugarReunion:t,escEstado:escuelaAct.escEstado,escUsuAdd:escuelaAct.escUsuAdd,escFechaCreacion:escuelaAct.escFechaCreacion,escFechaAdd:escuelaAct.escFechaAdd,idEscuela:escuelaAct.idEscuela,iglesia:{idIglesia:escuelaAct.iglesia.idIglesia}},eService.updateEscuela(e,reload))):alert("Campos Incompletos...")}function reload(e){0!==e&&eService.listEscuela({idIglesia:idIglesia},listEscuela)}function createModal(e,a,t,l){var s="";return s+='<h5 class="thin">Escuela Sabática</h5>',s+='<div class="row">',s+='<form class="col s12">',s+='<div class="row">',s+='<div class="input-field col s12 l6 m6">',s+='<i class="mdi-social-group prefix"></i>',s+='<input id="nesc" type="text" class="validate" value="'+a+'">',s+='<label for="nesc" class="'+l+'">Nombre</label>',s+="</div>",s+='<div class="input-field col s12 l6 m6">',s+='<i class="mdi-action-home prefix"></i>',s+='<input id="lgreu" type="text" class="validate" value="'+t+'">',s+='<label for="lgreu" class="'+l+'">Lugar de Reunión</label>',s+="</div>",s+="</div>",s+='<input type="hidden" value='+e+' id="tipModal">',(s+="</form>")+"</div>"}function createEscuela(){var e=createModal("create","","","");$(".modal-content").empty(),$(".modal-content").append(e),$("#modal1").openModal()}$(document).ready(function(){$(".titleTab").empty(),$(".titleTab").append("Listado de escuelas sabáticas que pertencen a la iglesia <strong>"+$("#crm_iglNombre").val().toUpperCase()+"</strong>");var e={idIglesia:idIglesia};eService.listEscuela(e,listEscuela)});