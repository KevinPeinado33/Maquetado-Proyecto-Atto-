var iglesiaProfile=function(){var r=$("#tab1"),i=$("#tab3"),e=$("#conModal"),l={},t=function(o){escuelaService.list({idIglesia:l.idIglesia},function(e){var a=[];$("#esc_count").html(e.length);for(var i=0;i<e.length;i++){var n=e[i],t=dateConverter.format.longStringToDate(n.escFechaRegistro);a.push({events:[{type:"click",action:"redirect('/escuela/profile/"+n.idEscuela+"')"}],cols:[{type:"card-table-image",src:appDefaults.defaults.logoGrupo,default:appDefaults.defaults.logoGrupo},{type:"card-table-content",label:"",value:n.escNombre},{type:"card-table-content",label:"Lugar de Reunión",value:void 0===n.escLugarReunion?"No registrado":n.escLugarReunion},{type:"card-table-content",label:"Fecha de Registro",value:t}]});var l=strings.random(8);components.render(r,components.cardTable.code(a,l)),components.cardTable.event(a,l),o()}})};return{init:function(){l.idIglesia=parseInt($("#info_iglesia_idIglesia").val()),l.nombre=$("#info_iglesia_nombre").val(),l.idDistrito=parseInt($("#info_iglesia_idDistrito").val()),t(function(){}),adminLeaders.listLeaders(3,i)},remove:function(){confirmMessage({title:"Eliminar",content:"¿Seguro que desea eliminar esta iglesia?"},function(){iglesiaService.remove({idIglesia:l.idIglesia},function(e){redirect("/menu")})})},update:function(){var a,i=$("#iglNombre").val(),n=$("#iglDireccion").val(),e=$("#iglFechaCreacion").val().split(" ");a=validate.incomplete([e[1]])?dateConverter.format.datePickerToString($("#iglFechaCreacion").val()):e[0];var t={idIglesia:l.idIglesia,distrito:{idDistrito:l.idDistrito},iglNombre:i,iglDireccion:n,iglFechaCreacion:a,iglFechaRegistro:new Date($("#info_iglesia_iglFechaRegistro").val()),iglEstado:"1"};iglesiaService.update(t,function(e){l.nombre=i,$("#tit_iglesia").empty().append(i+'<i class="mdi-navigation-more-vert right"></i>'),$("#i_fec").empty().append("Fecha de Creación : "+a),$("#iglFechaCreacion").val(a),$("#i_dir").empty().append("Dirección : "+n)})},addEscuela:function(){var e=$("#n_escNombre").val(),a=$("#n_escFechaCreacion").val(),i=$("#n_escLugarReunion").val();if(validate.incomplete([e,a,i])){var n={iglesia:{idIglesia:l.idIglesia},escNombre:e,escFechaCreacion:dateConverter.format.dateSlach(a),escLugarReunion:i};escuelaService.add(n,function(e){t(function(){})})}else infoMessage({title:message.incomplete.title,content:message.incomplete.content})},regEscuela:function(){components.render(e,'<div class="modal-content white"><h4>Registro de Escuela Sabática</h4><div class="row"><div class="col l12 m12 s12 input-field"><input type="text" id="n_escNombre" name="n_escNombre" value=""/><label for="n_escNombre">Nombre de la Escuela Sabática</label></div><div class="col l12 m12 s12 input-field"><input type="text" id="n_escFechaCreacion" name="n_iglFechaCreacion" value="" class="datepicker"/><label for="n_iglFechaCreacion">Fecha de Creacion</label></div><div class="col l12 m12 s12 input-field"><input type="text" id="n_escLugarReunion" name="n_escLugarReunion" value=""/><label for="n_escLugarReunion">Lugar de Reunión</label></div></div></div>'),$("#saveModal").empty().append("Registrar"),$("#saveModal").attr("onclick","iglesiaProfile.addEscuela()"),$(".datepicker").pickadate()},regLeader:function(){components.render(e,components.modalSetRol.code("persona-enabled","test",[{id:14,nombre:"Anciano de Iglesia"},{id:5,nombre:"MIPES de Iglesia"}])),select2.init(),$("#saveModal").empty().append("Asignar"),$("#saveModal").attr("onclick","iglesiaProfile.addLeader()")},addLeader:function(){var e=$("#persona").val(),a=$("#rolS").val();adminLeaders.addLeader(e,a,function(e){adminLeaders.listLeaders(3,i)})}}}();